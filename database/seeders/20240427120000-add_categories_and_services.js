'use strict';

/** @type {import('sequelize-cli').Migration} */
module.exports = {
  async up(queryInterface, Sequelize) {
    // 1. Insert 4 categories with local image URLs
    const categories = [
      {
        name: 'Billboards',
        description: 'Large outdoor advertising structures.',
        image_url: '/images/demo-data/categories/billboard.jpg',
        createdAt: new Date(),
        updatedAt: new Date(),
      },
      {
        name: 'Transit Ads',
        description: 'Advertisements on buses, trains, and transit shelters.',
        image_url: '/images/demo-data/categories/transit-ads.jpg',
        createdAt: new Date(),
        updatedAt: new Date(),
      },
      {
        name: 'Digital Screens',
        description: 'LED and LCD digital advertising screens.',
        image_url: '/images/demo-data/categories/digital-screens.jpg',
        createdAt: new Date(),
        updatedAt: new Date(),
      },
      {
        name: 'Street Furniture',
        description: 'Ads on benches, kiosks, and bus stops.',
        image_url: '/images/demo-data/categories/street furniture.jpg',
        createdAt: new Date(),
        updatedAt: new Date(),
      },
    ];
    await queryInterface.bulkInsert('Categories', categories, {});

    // 2. Get inserted categories (assuming auto-increment IDs start from the last max)
    const [insertedCategories] = await queryInterface.sequelize.query(
      `SELECT id, name FROM Categories WHERE name IN ('Billboards', 'Transit Ads', 'Digital Screens', 'Street Furniture')`
    );
    const categoryMap = {};
    insertedCategories.forEach(cat => { categoryMap[cat.name] = cat.id; });

    // 3. Get a few state IDs (first 6 for variety)
    const [states] = await queryInterface.sequelize.query(
      `SELECT id, name FROM States ORDER BY id ASC LIMIT 6`
    );
    const stateIds = states.map(s => s.id);
    const getStateId = (idx) => stateIds[idx % stateIds.length];

    // 4. Insert 6 services for each category
    const now = new Date();
    const services = [
      // Billboards
      {
        name: 'Highway Billboard',
        description: 'Prime location on NH8.',
        image_url: 'https://example.com/highway-billboard.jpg',
        price: 10000,
        location: 'NH8, Gujarat',
        category_id: categoryMap['Billboards'],
        state_id: getStateId(0),
        code: 'BB-NH8',
        media: 'Print',
        ftf: 'Frontlit',
        size: '20x10 ft',
        total_area: '200 sq ft',
        createdAt: now,
        updatedAt: now,
      },
      {
        name: 'City Center Billboard',
        description: 'Located in the heart of the city.',
        image_url: 'https://example.com/city-billboard.jpg',
        price: 15000,
        location: 'Ahmedabad',
        category_id: categoryMap['Billboards'],
        state_id: getStateId(1),
        code: 'BB-CTY',
        media: 'Print',
        ftf: 'Backlit',
        size: '15x8 ft',
        total_area: '120 sq ft',
        createdAt: now,
        updatedAt: now,
      },
      {
        name: 'Expressway Billboard',
        description: 'Visible from major expressways.',
        image_url: 'https://example.com/expressway-billboard.jpg',
        price: 12000,
        location: 'Mumbai-Pune Expressway',
        category_id: categoryMap['Billboards'],
        state_id: getStateId(2),
        code: 'BB-EXP',
        media: 'Print',
        ftf: 'Frontlit',
        size: '18x9 ft',
        total_area: '162 sq ft',
        createdAt: now,
        updatedAt: now,
      },
      {
        name: 'Airport Approach Billboard',
        description: 'Strategic spot near airport approach road.',
        image_url: 'https://example.com/airport-billboard.jpg',
        price: 18000,
        location: 'Delhi Airport Road',
        category_id: categoryMap['Billboards'],
        state_id: getStateId(3),
        code: 'BB-APR',
        media: 'Print',
        ftf: 'Backlit',
        size: '22x10 ft',
        total_area: '220 sq ft',
        createdAt: now,
        updatedAt: now,
      },
      {
        name: 'Market Square Billboard',
        description: 'High-traffic market area.',
        image_url: 'https://example.com/market-billboard.jpg',
        price: 9000,
        location: 'Chandni Chowk',
        category_id: categoryMap['Billboards'],
        state_id: getStateId(4),
        code: 'BB-MKT',
        media: 'Print',
        ftf: 'Frontlit',
        size: '12x8 ft',
        total_area: '96 sq ft',
        createdAt: now,
        updatedAt: now,
      },
      {
        name: 'Suburban Billboard',
        description: 'Located in suburban residential area.',
        image_url: 'https://example.com/suburban-billboard.jpg',
        price: 7000,
        location: 'Navi Mumbai',
        category_id: categoryMap['Billboards'],
        state_id: getStateId(5),
        code: 'BB-SUB',
        media: 'Print',
        ftf: 'Frontlit',
        size: '10x5 ft',
        total_area: '50 sq ft',
        createdAt: now,
        updatedAt: now,
      },
      // Transit Ads
      {
        name: 'Bus Wrap',
        description: 'Full bus wrap advertising.',
        image_url: 'https://example.com/bus-wrap.jpg',
        price: 8000,
        location: 'Bangalore',
        category_id: categoryMap['Transit Ads'],
        state_id: getStateId(0),
        code: 'TR-BUS',
        media: 'Vinyl',
        ftf: null,
        size: 'Full Bus',
        total_area: '300 sq ft',
        createdAt: now,
        updatedAt: now,
      },
      {
        name: 'Train Panel',
        description: 'Panel ads inside trains.',
        image_url: 'https://example.com/train-panel.jpg',
        price: 6000,
        location: 'Chennai',
        category_id: categoryMap['Transit Ads'],
        state_id: getStateId(1),
        code: 'TR-TRN',
        media: 'Sticker',
        ftf: null,
        size: '2x5 ft',
        total_area: '10 sq ft',
        createdAt: now,
        updatedAt: now,
      },
      {
        name: 'Metro Station Panel',
        description: 'Panels at metro stations.',
        image_url: 'https://example.com/metro-panel.jpg',
        price: 9000,
        location: 'Delhi Metro',
        category_id: categoryMap['Transit Ads'],
        state_id: getStateId(2),
        code: 'TR-MET',
        media: 'Vinyl',
        ftf: null,
        size: '3x8 ft',
        total_area: '24 sq ft',
        createdAt: now,
        updatedAt: now,
      },
      {
        name: 'Auto Rickshaw Branding',
        description: 'Branding on auto rickshaws.',
        image_url: 'https://example.com/auto-branding.jpg',
        price: 3000,
        location: 'Lucknow',
        category_id: categoryMap['Transit Ads'],
        state_id: getStateId(3),
        code: 'TR-AUTO',
        media: 'Sticker',
        ftf: null,
        size: 'Auto',
        total_area: '8 sq ft',
        createdAt: now,
        updatedAt: now,
      },
      {
        name: 'Cab Topper',
        description: 'Digital toppers on cabs.',
        image_url: 'https://example.com/cab-topper.jpg',
        price: 5000,
        location: 'Hyderabad',
        category_id: categoryMap['Transit Ads'],
        state_id: getStateId(4),
        code: 'TR-CAB',
        media: 'Digital',
        ftf: null,
        size: '2x1 ft',
        total_area: '2 sq ft',
        createdAt: now,
        updatedAt: now,
      },
      {
        name: 'Airport Shuttle Branding',
        description: 'Branding on airport shuttle buses.',
        image_url: 'https://example.com/shuttle-branding.jpg',
        price: 11000,
        location: 'Kolkata',
        category_id: categoryMap['Transit Ads'],
        state_id: getStateId(5),
        code: 'TR-SHUT',
        media: 'Vinyl',
        ftf: null,
        size: 'Shuttle',
        total_area: '20 sq ft',
        createdAt: now,
        updatedAt: now,
      },
      // Digital Screens
      {
        name: 'Mall LED Screen',
        description: 'Large LED screen in shopping mall.',
        image_url: 'https://example.com/mall-led.jpg',
        price: 12000,
        location: 'Delhi',
        category_id: categoryMap['Digital Screens'],
        state_id: getStateId(0),
        code: 'DS-LED',
        media: 'Digital',
        ftf: null,
        size: '10x6 ft',
        total_area: '60 sq ft',
        createdAt: now,
        updatedAt: now,
      },
      {
        name: 'Airport Digital Board',
        description: 'Premium digital board at airport.',
        image_url: 'https://example.com/airport-digital.jpg',
        price: 25000,
        location: 'Mumbai',
        category_id: categoryMap['Digital Screens'],
        state_id: getStateId(1),
        code: 'DS-AP',
        media: 'Digital',
        ftf: null,
        size: '12x8 ft',
        total_area: '96 sq ft',
        createdAt: now,
        updatedAt: now,
      },
      {
        name: 'Cinema Foyer Screen',
        description: 'Digital screen in cinema foyer.',
        image_url: 'https://example.com/cinema-screen.jpg',
        price: 9000,
        location: 'PVR Cinemas',
        category_id: categoryMap['Digital Screens'],
        state_id: getStateId(2),
        code: 'DS-CIN',
        media: 'Digital',
        ftf: null,
        size: '8x5 ft',
        total_area: '40 sq ft',
        createdAt: now,
        updatedAt: now,
      },
      {
        name: 'Outdoor LED Hoarding',
        description: 'Outdoor digital hoarding.',
        image_url: 'https://example.com/outdoor-led.jpg',
        price: 14000,
        location: 'Bangalore',
        category_id: categoryMap['Digital Screens'],
        state_id: getStateId(3),
        code: 'DS-OUT',
        media: 'Digital',
        ftf: null,
        size: '14x7 ft',
        total_area: '98 sq ft',
        createdAt: now,
        updatedAt: now,
      },
      {
        name: 'Retail Store Display',
        description: 'Digital display in retail store.',
        image_url: 'https://example.com/retail-display.jpg',
        price: 7000,
        location: 'Big Bazaar',
        category_id: categoryMap['Digital Screens'],
        state_id: getStateId(4),
        code: 'DS-RTL',
        media: 'Digital',
        ftf: null,
        size: '6x4 ft',
        total_area: '24 sq ft',
        createdAt: now,
        updatedAt: now,
      },
      {
        name: 'Corporate Lobby Screen',
        description: 'Screen in corporate office lobby.',
        image_url: 'https://example.com/lobby-screen.jpg',
        price: 16000,
        location: 'Cyber City',
        category_id: categoryMap['Digital Screens'],
        state_id: getStateId(5),
        code: 'DS-LOB',
        media: 'Digital',
        ftf: null,
        size: '9x5 ft',
        total_area: '45 sq ft',
        createdAt: now,
        updatedAt: now,
      },
      // Street Furniture
      {
        name: 'Bus Shelter Ad',
        description: 'Ad panel on bus shelter.',
        image_url: 'https://example.com/bus-shelter.jpg',
        price: 5000,
        location: 'Pune',
        category_id: categoryMap['Street Furniture'],
        state_id: getStateId(0),
        code: 'SF-BS',
        media: 'Print',
        ftf: null,
        size: '6x3 ft',
        total_area: '18 sq ft',
        createdAt: now,
        updatedAt: now,
      },
      {
        name: 'Kiosk Branding',
        description: 'Branding on public kiosks.',
        image_url: 'https://example.com/kiosk.jpg',
        price: 4000,
        location: 'Hyderabad',
        category_id: categoryMap['Street Furniture'],
        state_id: getStateId(1),
        code: 'SF-KSK',
        media: 'Print',
        ftf: null,
        size: '4x6 ft',
        total_area: '24 sq ft',
        createdAt: now,
        updatedAt: now,
      },
      {
        name: 'Park Bench Ad',
        description: 'Ad on public park benches.',
        image_url: 'https://example.com/bench-ad.jpg',
        price: 3500,
        location: 'Cubbon Park',
        category_id: categoryMap['Street Furniture'],
        state_id: getStateId(2),
        code: 'SF-BEN',
        media: 'Print',
        ftf: null,
        size: '5x2 ft',
        total_area: '10 sq ft',
        createdAt: now,
        updatedAt: now,
      },
      {
        name: 'Public Toilet Branding',
        description: 'Branding on public toilets.',
        image_url: 'https://example.com/toilet-branding.jpg',
        price: 2000,
        location: 'Connaught Place',
        category_id: categoryMap['Street Furniture'],
        state_id: getStateId(3),
        code: 'SF-PTB',
        media: 'Print',
        ftf: null,
        size: '6x4 ft',
        total_area: '24 sq ft',
        createdAt: now,
        updatedAt: now,
      },
      {
        name: 'Information Kiosk',
        description: 'Digital information kiosks.',
        image_url: 'https://example.com/info-kiosk.jpg',
        price: 6000,
        location: 'MG Road',
        category_id: categoryMap['Street Furniture'],
        state_id: getStateId(4),
        code: 'SF-INF',
        media: 'Digital',
        ftf: null,
        size: '3x7 ft',
        total_area: '21 sq ft',
        createdAt: now,
        updatedAt: now,
      },
      {
        name: 'Shopping Mall Bench Ad',
        description: 'Ad on benches inside shopping malls.',
        image_url: 'https://example.com/mall-bench.jpg',
        price: 4500,
        location: 'Phoenix Mall',
        category_id: categoryMap['Street Furniture'],
        state_id: getStateId(5),
        code: 'SF-MBN',
        media: 'Print',
        ftf: null,
        size: '5x2 ft',
        total_area: '10 sq ft',
        createdAt: now,
        updatedAt: now,
      },
    ];
    await queryInterface.bulkInsert('Services', services, {});
  },

  async down(queryInterface, Sequelize) {
    await queryInterface.bulkDelete('Services', {
      name: [
        'Highway Billboard',
        'City Center Billboard',
        'Expressway Billboard',
        'Airport Approach Billboard',
        'Market Square Billboard',
        'Suburban Billboard',
        'Bus Wrap',
        'Train Panel',
        'Metro Station Panel',
        'Auto Rickshaw Branding',
        'Cab Topper',
        'Airport Shuttle Branding',
        'Mall LED Screen',
        'Airport Digital Board',
        'Cinema Foyer Screen',
        'Outdoor LED Hoarding',
        'Retail Store Display',
        'Corporate Lobby Screen',
        'Bus Shelter Ad',
        'Kiosk Branding',
        'Park Bench Ad',
        'Public Toilet Branding',
        'Information Kiosk',
        'Shopping Mall Bench Ad',
      ]
    }, {});
    await queryInterface.bulkDelete('Categories', {
      name: [
        'Billboards',
        'Transit Ads',
        'Digital Screens',
        'Street Furniture',
      ]
    }, {});
  }
}; 